<?xml version="1.0" encoding="utf-8"?>
<odoo>
    
    <!-- Jurnal Index Page -->
    <template id="jurnal_index" name="Daftar Jurnal Ilmiah">
        <t t-call="website.layout">
            <div id="wrap">
                <!-- Page Header -->
                <section class="bg-light py-5">
                    <div class="container">
                        <div class="row">
                            <div class="col-lg-8">
                                <h1 class="display-4 fw-bold">Jurnal Ilmiah</h1>
                                <p class="lead">Koleksi publikasi jurnal ilmiah nasional &amp; internasional</p>
                            </div>
                            <div class="col-lg-4">
                                <div class="card">
                                    <div class="card-body">
                                        <h5 class="card-title">Statistik</h5>
                                        <div class="row text-center">
                                            <div class="col-6">
                                                <h4 class="text-primary"><t t-esc="stats['total_articles']"/></h4>
                                                <small class="text-muted">Total Artikel</small>
                                            </div>
                                            <div class="col-6">
                                                <h4 class="text-success"><t t-esc="stats['scopus_articles']"/></h4>
                                                <small class="text-muted">Scopus</small>
                                            </div>
                                        </div>
                                        <div class="row text-center mt-2">
                                            <div class="col-6">
                                                <h5 class="text-info"><t t-esc="stats['wos_articles']"/></h5>
                                                <small class="text-muted">Web of Science</small>
                                            </div>
                                            <div class="col-6">
                                                <h5 class="text-warning"><t t-esc="stats['sinta_articles']"/></h5>
                                                <small class="text-muted">SINTA</small>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- Search and Filters -->
                <section class="py-4 border-bottom">
                    <div class="container">
                        <form method="get" class="row g-3">
                            <div class="col-md-3">
                                <input type="text" class="form-control" name="search" 
                                       placeholder="Cari judul, penulis, jurnal, atau kata kunci..." 
                                       t-att-value="search"/>
                            </div>
                            <div class="col-md-2">
                                <select name="category_id" class="form-select">
                                    <option value="">Semua Kategori</option>
                                    <t t-foreach="categories" t-as="category">
                                        <option t-att-value="category.id" 
                                                t-att-selected="category_id == category.id">
                                            <t t-esc="category.name"/>
                                        </option>
                                    </t>
                                </select>
                            </div>
                            <div class="col-md-2">
                                <select name="indexing" class="form-select">
                                    <option value="">Semua Indexing</option>
                                    <option value="scopus" t-att-selected="indexing == 'scopus'">Scopus</option>
                                    <option value="wos" t-att-selected="indexing == 'wos'">Web of Science</option>
                                    <option value="sinta" t-att-selected="indexing == 'sinta'">SINTA</option>
                                    <option value="doaj" t-att-selected="indexing == 'doaj'">DOAJ</option>
                                </select>
                            </div>
                            <div class="col-md-2">
                                <select name="publisher" class="form-select">
                                    <option value="">Semua Penerbit</option>
                                    <t t-foreach="publishers" t-as="pub">
                                        <option t-att-value="pub" t-att-selected="publisher == pub">
                                            <t t-esc="pub"/>
                                        </option>
                                    </t>
                                </select>
                            </div>
                            <div class="col-md-2">
                                <select name="year" class="form-select">
                                    <option value="">Semua Tahun</option>
                                    <t t-foreach="years" t-as="yr">
                                        <option t-att-value="yr" t-att-selected="year == yr">
                                            <t t-esc="yr"/>
                                        </option>
                                    </t>
                                </select>
                            </div>
                            <div class="col-md-1">
                                <button type="submit" class="btn btn-primary w-100">
                                    <i class="fa fa-search"/>
                                </button>
                            </div>
                        </form>
                    </div>
                </section>

                <!-- Results -->
                <section class="py-5">
                    <div class="container">
                        <t t-if="not posts">
                            <div class="text-center py-5">
                                <i class="fa fa-search fa-3x text-muted mb-3"/>
                                <h3 class="text-muted">Tidak ada artikel ditemukan</h3>
                                <p class="text-muted">Coba ubah kriteria pencarian Anda</p>
                            </div>
                        </t>
                        
                        <t t-else="">
                            <div class="row">
                                <t t-foreach="posts" t-as="post">
                                    <div class="col-lg-6 col-xl-4 mb-4">
                                        <div class="card h-100 shadow-sm">
                                            <div class="card-header bg-light">
                                                <small class="text-muted">
                                                    <t t-esc="post.journal_name"/> • 
                                                    <t t-esc="post.publication_date" t-options="{'widget': 'date'}"/>
                                                </small>
                                            </div>
                                            <div class="card-body">
                                                <h5 class="card-title">
                                                    <a t-att-href="post.website_url" class="text-decoration-none text-dark">
                                                        <t t-esc="post.name"/>
                                                    </a>
                                                </h5>
                                                <p class="card-text">
                                                    <strong>Penulis:</strong> <t t-esc="post.authors"/>
                                                </p>
                                                
                                                <!-- Teaser/Preview -->
                                                <p class="card-text text-muted small" t-if="post.teaser">
                                                    <t t-esc="post.teaser"/>
                                                </p>
                                                
                                                <!-- Indexing Badges -->
                                                <div class="mb-2">
                                                    <t t-if="post.scopus_indexed">
                                                        <span class="badge bg-success me-1">Scopus</span>
                                                    </t>
                                                    <t t-if="post.wos_indexed">
                                                        <span class="badge bg-primary me-1">WoS</span>
                                                    </t>
                                                    <t t-if="post.sinta_indexed">
                                                        <span class="badge bg-warning text-dark me-1">
                                                            SINTA <t t-esc="post.sinta_rank"/>
                                                        </span>
                                                    </t>
                                                    <t t-if="post.doaj_indexed">
                                                        <span class="badge bg-info me-1">DOAJ</span>
                                                    </t>
                                                </div>
                                                
                                                <!-- Metrics -->
                                                <div class="small text-muted">
                                                    <t t-if="post.impact_factor > 0">
                                                        IF: <t t-esc="post.impact_factor"/> • 
                                                    </t>
                                                    <t t-if="post.quartile">
                                                        <t t-esc="post.quartile"/> • 
                                                    </t>
                                                    <t t-if="post.citations > 0">
                                                        <t t-esc="post.citations"/> sitasi • 
                                                    </t>
                                                    <t t-esc="post.visits"/> views
                                                </div>
                                            </div>
                                            <div class="card-footer bg-transparent">
                                                <small class="text-muted">
                                                    <i class="fa fa-folder-o"/> <t t-esc="post.blog_id.name"/>
                                                    <t t-if="post.publisher">
                                                        • <i class="fa fa-building-o"/> <t t-esc="post.publisher"/>
                                                    </t>
                                                </small>
                                            </div>
                                        </div>
                                    </div>
                                </t>
                            </div>
                            
                            <!-- Pagination -->
                            <div class="d-flex justify-content-center mt-4">
                                <t t-call="website.pager"/>
                            </div>
                        </t>
                    </div>
                </section>
            </div>
        </t>
    </template>
    
    <!-- Jurnal Post Detail Page -->
    <template id="jurnal_post_detail" name="Detail Jurnal Ilmiah">
        <t t-call="website.layout">
            <!-- Set website title and meta -->
            <t t-set="title" t-value="post.get_meta_title()"/>
            <t t-set="website_meta_title" t-value="post.get_meta_title()"/>
            <t t-set="website_meta_description" t-value="post.get_meta_description()"/>
            <t t-set="website_meta_keywords" t-value="post.get_meta_keywords()"/>
            
            <!-- Custom head content -->
            <t t-set="head">
                <t t-raw="0"/>
                <!-- SEO Meta Tags -->
                <meta name="description" t-att-content="post.get_meta_description()"/>
                <meta name="keywords" t-att-content="post.get_meta_keywords()"/>
                
                <!-- Open Graph Tags -->
                <meta property="og:title" t-att-content="post.get_meta_title()"/>
                <meta property="og:description" t-att-content="post.get_meta_description()"/>
                <meta property="og:type" content="article"/>
                <meta property="og:url" t-att-content="request.httprequest.url"/>
                
                <!-- Twitter Cards -->
                <meta name="twitter:card" content="summary_large_image"/>
                <meta name="twitter:title" t-att-content="post.get_meta_title()"/>
                <meta name="twitter:description" t-att-content="post.get_meta_description()"/>
                
                <!-- Article specific meta -->
                <meta name="author" t-att-content="post.authors"/>
                <meta name="article:published_time" t-att-content="post.publication_date"/>
                <meta name="article:section" t-att-content="post.blog_id.name"/>
            </t>
            
            <div id="wrap" class="oe_structure my-4 py-4">
                <div class="container mt-4">
                    <div class="row">
                        <div class="col-lg-8">
                            <!-- Article Header -->
                            <div class="mb-4">
                                <h1 t-field="post.name"/>
                                <h4 class="text-muted" t-field="post.subtitle" t-if="post.subtitle"/>
                                
                                <div class="row mt-3">
                                    <div class="col-md-6">
                                        <p><strong>Penulis:</strong> <span t-field="post.authors"/></p>
                                        <p t-if="post.corresponding_author">
                                            <strong>Penulis Korespondensi:</strong> 
                                            <span t-field="post.corresponding_author"/>
                                        </p>
                                        <p><strong>Jurnal:</strong> <span t-field="post.journal_name"/></p>
                                        <p t-if="post.publisher">
                                            <strong>Penerbit:</strong> <a t-attf-href="post.publisher_website" target="_blank">
                                                <span t-field="post.publisher"/>
                                            </a>
                                        </p>
                                    </div>
                                    <div class="col-md-6">
                                        <p><strong>Tanggal Publikasi:</strong> 
                                           <span t-field="post.publication_date" t-options="{'widget': 'date'}"/>
                                        </p>
                                        <p t-if="post.volume">
                                            <strong>Volume:</strong> <span t-field="post.volume"/>
                                            <t t-if="post.issue">, Issue: <span t-field="post.issue"/></t>
                                        </p>
                                        <p t-if="post.pages">
                                            <strong>Halaman:</strong> <span t-field="post.pages"/>
                                        </p>
                                        <p t-if="post.doi">
                                            <strong>DOI:</strong> 
                                            <a t-attf-href="https://doi.org/#{post.doi}" target="_blank">
                                                <span t-field="post.doi"/>
                                            </a>
                                        </p>
                                    </div>
                                </div>
                                
                                <!-- Indexing & Metrics -->
                                <div class="row mt-3">
                                    <div class="col-12">
                                        <div class="d-flex flex-wrap mb-2">
                                            <t t-if="post.scopus_indexed">
                                                <span class="badge bg-success me-2 mb-1">Scopus Indexed</span>
                                            </t>
                                            <t t-if="post.wos_indexed">
                                                <span class="badge bg-primary me-2 mb-1">Web of Science</span>
                                            </t>
                                            <t t-if="post.sinta_indexed">
                                                <span class="badge bg-warning text-dark me-2 mb-1">
                                                    SINTA <t t-esc="post.sinta_rank"/>
                                                </span>
                                            </t>
                                            <t t-if="post.doaj_indexed">
                                                <span class="badge bg-info me-2 mb-1">DOAJ</span>
                                            </t>
                                        </div>
                                        
                                        <div class="small text-muted">
                                            <t t-if="post.impact_factor > 0">
                                                Impact Factor: <strong t-esc="post.impact_factor"/> • 
                                            </t>
                                            <t t-if="post.quartile">
                                                Quartile: <strong t-esc="post.quartile"/> • 
                                            </t>
                                            <t t-if="post.h_index > 0">
                                                H-Index: <strong t-esc="post.h_index"/> • 
                                            </t>
                                            <t t-if="post.citations > 0">
                                                Sitasi: <strong t-esc="post.citations"/> • 
                                            </t>
                                            Views: <strong t-esc="post.visits"/>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Article Content -->
                            <div class="mb-4">
                                <h3>Abstrak</h3>
                                <div t-field="post.content" class="oe_structure"/>
                            </div>
                            
                            <!-- Keywords & Subject -->
                            <div class="row mb-4" t-if="post.keywords or post.subject_area">
                                <div class="col-md-6" t-if="post.keywords">
                                    <h5>Kata Kunci</h5>
                                    <p t-field="post.keywords"/>
                                </div>
                                <div class="col-md-6" t-if="post.subject_area">
                                    <h5>Bidang Subjek</h5>
                                    <p t-field="post.subject_area"/>
                                </div>
                            </div>

                        </div>
                        
                        <!-- Sidebar -->
                        <div class="col-lg-4 mb-4">
                            <div class="card">
                                <div class="card-header">
                                    <h5>Informasi Tambahan</h5>
                                </div>
                                <div class="card-body">
                                    <p t-if="post.url">
                                        <strong>Jurnal:</strong><br/>
                                        <a t-att-href="post.url" target="_blank" class="btn btn-sm btn-outline-primary">
                                            Lihat Jurnal
                                        </a>
                                    </p>
                                    
                                    <div t-if="post.research_area">
                                        <strong>Area Penelitian:</strong>
                                        <p t-field="post.research_area"/>
                                    </div>
                                    
                                    <div class="small text-muted mt-3">
                                        <p>Kategori: <span t-field="post.blog_id.name"/></p>
                                        <p>Diterbitkan: <span t-field="post.create_date" t-options="{'widget': 'datetime'}"/></p>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Related Articles -->
                            <div class="card mt-4" t-if="related_posts">
                                <div class="card-header">
                                    <h5>Jurnal Terkait</h5>
                                </div>
                                <div class="card-body">
                                    <t t-foreach="related_posts" t-as="related">
                                        <div class="mb-3">
                                            <a t-att-href="related.website_url" class="text-decoration-none">
                                                <h6 t-esc="related.name"/>
                                            </a>
                                            <small class="text-muted d-block">
                                                <t t-esc="related.authors"/> • 
                                                <t t-esc="related.publication_date" t-options="{'widget': 'date'}"/>
                                            </small>
                                        </div>
                                    </t>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </t>
    </template>
    
    <!-- Category Page -->
    <template id="jurnal_category" name="Kategori Jurnal">
        <t t-call="website.layout">
            <div id="wrap" class="oe_structure my-4 py-4">
                <div class="container mt-4">
                    <div class="row">
                        <div class="col-12">
                            <h1 t-field="category.name"/>
                            <p class="text-muted" t-field="category.subtitle"/>
                            
                            <div class="row">
                                <t t-foreach="posts" t-as="post">
                                    <div class="col-lg-6 col-xl-4 mb-4">
                                        <div class="card h-100">
                                            <div class="card-body">
                                                <h5 class="card-title">
                                                    <a t-att-href="post.website_url">
                                                        <t t-esc="post.name"/>
                                                    </a>
                                                </h5>
                                                <p><strong>Penulis:</strong> <t t-esc="post.authors"/></p>
                                                <p><strong>Jurnal:</strong> <t t-esc="post.journal_name"/></p>
                                                <small class="text-muted">
                                                    <t t-esc="post.publication_date" t-options="{'widget': 'date'}"/>
                                                </small>
                                            </div>
                                        </div>
                                    </div>
                                </t>
                            </div>
                            
                            <t t-call="website.pager"/>
                        </div>
                    </div>
                </div>
            </div>
        </t>
    </template>
    
</odoo>